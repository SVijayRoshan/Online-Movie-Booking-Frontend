import{k as $,r as a,o as xe,j as t,P as y,l as x,h as we,i as q,p as Te,s as Ie,a as M,d as je,e as Fe,g as ye,L as Re}from"./index-YhsNIgvP.js";import{u as B}from"./useMutation-CLwU4-RE.js";import{F as Ce,B as V,a as U}from"./button-Duyd6bEY.js";import{C as Ne}from"./card-CfP9Vloi.js";import{I as R}from"./input-BxC0n9rW.js";import{L as C}from"./label-BgjeurpF.js";import{u as Y}from"./index-CEcT7utf.js";import{u as z}from"./index-umRYUILS.js";var _="rovingFocusGroup.onEntryFocus",Ee={bubbles:!1,cancelable:!0},N="RovingFocusGroup",[L,H,Se]=xe(N),[Pe,W]=$(N,[Se]),[Ae,_e]=Pe(N),J=a.forwardRef((e,s)=>t.jsx(L.Provider,{scope:e.__scopeRovingFocusGroup,children:t.jsx(L.Slot,{scope:e.__scopeRovingFocusGroup,children:t.jsx(Le,{...e,ref:s})})}));J.displayName=N;var Le=a.forwardRef((e,s)=>{const{__scopeRovingFocusGroup:r,orientation:o,loop:d=!1,dir:f,currentTabStopId:c,defaultCurrentTabStopId:m,onCurrentTabStopIdChange:b,onEntryFocus:g,preventScrollOnEntryFocus:i=!1,...l}=e,p=a.useRef(null),w=we(s,p),T=z(f),[F,u]=q({prop:c,defaultProp:m??null,onChange:b,caller:N}),[n,S]=a.useState(!1),h=Te(g),I=H(r),P=a.useRef(!1),[ge,K]=a.useState(0);return a.useEffect(()=>{const v=p.current;if(v)return v.addEventListener(_,h),()=>v.removeEventListener(_,h)},[h]),t.jsx(Ae,{scope:r,orientation:o,dir:T,loop:d,currentTabStopId:F,onItemFocus:a.useCallback(v=>u(v),[u]),onItemShiftTab:a.useCallback(()=>S(!0),[]),onFocusableItemAdd:a.useCallback(()=>K(v=>v+1),[]),onFocusableItemRemove:a.useCallback(()=>K(v=>v-1),[]),children:t.jsx(y.div,{tabIndex:n||ge===0?-1:0,"data-orientation":o,...l,ref:w,style:{outline:"none",...e.style},onMouseDown:x(e.onMouseDown,()=>{P.current=!0}),onFocus:x(e.onFocus,v=>{const pe=!P.current;if(v.target===v.currentTarget&&pe&&!n){const O=new CustomEvent(_,Ee);if(v.currentTarget.dispatchEvent(O),!O.defaultPrevented){const A=I().filter(j=>j.focusable),ve=A.find(j=>j.active),be=A.find(j=>j.id===F),he=[ve,be,...A].filter(Boolean).map(j=>j.ref.current);Z(he,i)}}P.current=!1}),onBlur:x(e.onBlur,()=>S(!1))})})}),Q="RovingFocusGroupItem",X=a.forwardRef((e,s)=>{const{__scopeRovingFocusGroup:r,focusable:o=!0,active:d=!1,tabStopId:f,children:c,...m}=e,b=Y(),g=f||b,i=_e(Q,r),l=i.currentTabStopId===g,p=H(r),{onFocusableItemAdd:w,onFocusableItemRemove:T,currentTabStopId:F}=i;return a.useEffect(()=>{if(o)return w(),()=>T()},[o,w,T]),t.jsx(L.ItemSlot,{scope:r,id:g,focusable:o,active:d,children:t.jsx(y.span,{tabIndex:l?0:-1,"data-orientation":i.orientation,...m,ref:s,onMouseDown:x(e.onMouseDown,u=>{o?i.onItemFocus(g):u.preventDefault()}),onFocus:x(e.onFocus,()=>i.onItemFocus(g)),onKeyDown:x(e.onKeyDown,u=>{if(u.key==="Tab"&&u.shiftKey){i.onItemShiftTab();return}if(u.target!==u.currentTarget)return;const n=Me(u,i.orientation,i.dir);if(n!==void 0){if(u.metaKey||u.ctrlKey||u.altKey||u.shiftKey)return;u.preventDefault();let h=p().filter(I=>I.focusable).map(I=>I.ref.current);if(n==="last")h.reverse();else if(n==="prev"||n==="next"){n==="prev"&&h.reverse();const I=h.indexOf(u.currentTarget);h=i.loop?Ge(h,I+1):h.slice(I+1)}setTimeout(()=>Z(h))}}),children:typeof c=="function"?c({isCurrentTabStop:l,hasTabStop:F!=null}):c})})});X.displayName=Q;var ke={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function De(e,s){return s!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Me(e,s,r){const o=De(e.key,r);if(!(s==="vertical"&&["ArrowLeft","ArrowRight"].includes(o))&&!(s==="horizontal"&&["ArrowUp","ArrowDown"].includes(o)))return ke[o]}function Z(e,s=!1){const r=document.activeElement;for(const o of e)if(o===r||(o.focus({preventScroll:s}),document.activeElement!==r))return}function Ge(e,s){return e.map((r,o)=>e[(s+o)%e.length])}var Ke=J,Oe=X,E="Tabs",[Be]=$(E,[W]),ee=W(),[Ve,G]=Be(E),te=a.forwardRef((e,s)=>{const{__scopeTabs:r,value:o,onValueChange:d,defaultValue:f,orientation:c="horizontal",dir:m,activationMode:b="automatic",...g}=e,i=z(m),[l,p]=q({prop:o,onChange:d,defaultProp:f??"",caller:E});return t.jsx(Ve,{scope:r,baseId:Y(),value:l,onValueChange:p,orientation:c,dir:i,activationMode:b,children:t.jsx(y.div,{dir:i,"data-orientation":c,...g,ref:s})})});te.displayName=E;var se="TabsList",oe=a.forwardRef((e,s)=>{const{__scopeTabs:r,loop:o=!0,...d}=e,f=G(se,r),c=ee(r);return t.jsx(Ke,{asChild:!0,...c,orientation:f.orientation,dir:f.dir,loop:o,children:t.jsx(y.div,{role:"tablist","aria-orientation":f.orientation,...d,ref:s})})});oe.displayName=se;var re="TabsTrigger",ne=a.forwardRef((e,s)=>{const{__scopeTabs:r,value:o,disabled:d=!1,...f}=e,c=G(re,r),m=ee(r),b=ce(c.baseId,o),g=le(c.baseId,o),i=o===c.value;return t.jsx(Oe,{asChild:!0,...m,focusable:!d,active:i,children:t.jsx(y.button,{type:"button",role:"tab","aria-selected":i,"aria-controls":g,"data-state":i?"active":"inactive","data-disabled":d?"":void 0,disabled:d,id:b,...f,ref:s,onMouseDown:x(e.onMouseDown,l=>{!d&&l.button===0&&l.ctrlKey===!1?c.onValueChange(o):l.preventDefault()}),onKeyDown:x(e.onKeyDown,l=>{[" ","Enter"].includes(l.key)&&c.onValueChange(o)}),onFocus:x(e.onFocus,()=>{const l=c.activationMode!=="manual";!i&&!d&&l&&c.onValueChange(o)})})})});ne.displayName=re;var ae="TabsContent",ie=a.forwardRef((e,s)=>{const{__scopeTabs:r,value:o,forceMount:d,children:f,...c}=e,m=G(ae,r),b=ce(m.baseId,o),g=le(m.baseId,o),i=o===m.value,l=a.useRef(i);return a.useEffect(()=>{const p=requestAnimationFrame(()=>l.current=!1);return()=>cancelAnimationFrame(p)},[]),t.jsx(Ie,{present:d||i,children:({present:p})=>t.jsx(y.div,{"data-state":i?"active":"inactive","data-orientation":m.orientation,role:"tabpanel","aria-labelledby":b,hidden:!p,id:g,tabIndex:0,...c,ref:s,style:{...e.style,animationDuration:l.current?"0s":void 0},children:p&&f})})});ie.displayName=ae;function ce(e,s){return`${e}-trigger-${s}`}function le(e,s){return`${e}-content-${s}`}var Ue=te,ue=oe,de=ne,fe=ie;const $e=Ue,me=a.forwardRef(({className:e,...s},r)=>t.jsx(ue,{ref:r,className:M("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));me.displayName=ue.displayName;const k=a.forwardRef(({className:e,...s},r)=>t.jsx(de,{ref:r,className:M("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));k.displayName=de.displayName;const D=a.forwardRef(({className:e,...s},r)=>t.jsx(fe,{ref:r,className:M("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));D.displayName=fe.displayName;function et(){const[,e]=je(),{login:s}=Fe(),{toast:r}=ye(),[o,d]=a.useState(""),[f,c]=a.useState(""),[m,b]=a.useState(""),[g,i]=a.useState(""),[l,p]=a.useState(""),w=B({mutationFn:()=>U.login(o,f),onSuccess:n=>{s(n.user,n.token),r({title:"Welcome back!",description:"You have successfully logged in"}),e("/")},onError:n=>{r({title:"Login failed",description:n.message,variant:"destructive"})}}),T=B({mutationFn:()=>U.register(g,l,m),onSuccess:n=>{s(n.user,n.token),r({title:"Account created!",description:"Welcome to CineBook"}),e("/")},onError:n=>{r({title:"Registration failed",description:n.message,variant:"destructive"})}}),F=n=>{n.preventDefault(),w.mutate()},u=n=>{n.preventDefault(),T.mutate()};return t.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:t.jsxs("div",{className:"w-full max-w-md",children:[t.jsx(Re,{href:"/",children:t.jsxs("div",{className:"flex items-center justify-center gap-2 mb-8 cursor-pointer",children:[t.jsx(Ce,{className:"w-8 h-8 text-primary"}),t.jsx("span",{className:"text-2xl font-bold font-display",children:"CineBook"})]})}),t.jsx(Ne,{className:"p-6",children:t.jsxs($e,{defaultValue:"login",className:"w-full",children:[t.jsxs(me,{className:"grid w-full grid-cols-2",children:[t.jsx(k,{value:"login","data-testid":"tab-login",children:"Login"}),t.jsx(k,{value:"register","data-testid":"tab-register",children:"Register"})]}),t.jsx(D,{value:"login",children:t.jsxs("form",{onSubmit:F,className:"space-y-4 mt-4",children:[t.jsxs("div",{children:[t.jsx(C,{htmlFor:"login-email",children:"Email"}),t.jsx(R,{id:"login-email",type:"email",value:o,onChange:n=>d(n.target.value),required:!0,"data-testid":"input-login-email"})]}),t.jsxs("div",{children:[t.jsx(C,{htmlFor:"login-password",children:"Password"}),t.jsx(R,{id:"login-password",type:"password",value:f,onChange:n=>c(n.target.value),required:!0,"data-testid":"input-login-password"})]}),t.jsx(V,{type:"submit",className:"w-full",disabled:w.isPending,"data-testid":"button-login",children:w.isPending?"Logging in...":"Login"}),t.jsx("p",{className:"text-sm text-center text-muted-foreground",children:"Tip: Register first, then login with your password"})]})}),t.jsx(D,{value:"register",children:t.jsxs("form",{onSubmit:u,className:"space-y-4 mt-4",children:[t.jsxs("div",{children:[t.jsx(C,{htmlFor:"register-name",children:"Full Name"}),t.jsx(R,{id:"register-name",value:m,onChange:n=>b(n.target.value),required:!0,"data-testid":"input-register-name"})]}),t.jsxs("div",{children:[t.jsx(C,{htmlFor:"register-email",children:"Email"}),t.jsx(R,{id:"register-email",type:"email",value:g,onChange:n=>i(n.target.value),required:!0,"data-testid":"input-register-email"})]}),t.jsxs("div",{children:[t.jsx(C,{htmlFor:"register-password",children:"Password"}),t.jsx(R,{id:"register-password",type:"password",value:l,onChange:n=>p(n.target.value),required:!0,"data-testid":"input-register-password"})]}),t.jsx(V,{type:"submit",className:"w-full",disabled:T.isPending,"data-testid":"button-register",children:T.isPending?"Creating account...":"Register"})]})})]})})]})})}export{et as default};
