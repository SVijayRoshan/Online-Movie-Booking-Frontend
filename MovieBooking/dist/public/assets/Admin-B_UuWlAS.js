import{c as L,r as i,j as e,a as h,i as xe,k as he,h as M,P as y,l as j,s as E,t as ve,v as je,D as ye,w as De,X as Ne,g as be,q as $}from"./index-YhsNIgvP.js";import{u as Ce,H as Re}from"./Header-CL76FjJX.js";import{u as q}from"./useMutation-CLwU4-RE.js";import{a as P,B as _}from"./button-Duyd6bEY.js";import{P as Pe}from"./ProtectedRoute-BkExmAMJ.js";import{C as _e}from"./card-CfP9Vloi.js";import{I as v}from"./input-BxC0n9rW.js";import{L as x}from"./label-BgjeurpF.js";import{u as w}from"./index-CEcT7utf.js";import{h as we,R as Me,u as Ee,F as Ae}from"./Combination-BY_svM0-.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=L("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=L("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),W=i.forwardRef(({className:t,...a},s)=>e.jsx("textarea",{className:h("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...a}));W.displayName="Textarea";var b="Dialog",[G]=he(b),[Te,g]=G(b),H=t=>{const{__scopeDialog:a,children:s,open:n,defaultOpen:r,onOpenChange:o,modal:d=!0}=t,c=i.useRef(null),u=i.useRef(null),[p,m]=xe({prop:n,defaultProp:r??!1,onChange:o,caller:b});return e.jsx(Te,{scope:a,triggerRef:c,contentRef:u,contentId:w(),titleId:w(),descriptionId:w(),open:p,onOpenChange:m,onOpenToggle:i.useCallback(()=>m(D=>!D),[m]),modal:d,children:s})};H.displayName=b;var U="DialogTrigger",z=i.forwardRef((t,a)=>{const{__scopeDialog:s,...n}=t,r=g(U,s),o=M(a,r.triggerRef);return e.jsx(y.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":O(r.open),...n,ref:o,onClick:j(t.onClick,r.onOpenToggle)})});z.displayName=U;var A="DialogPortal",[Fe,B]=G(A,{forceMount:void 0}),K=t=>{const{__scopeDialog:a,forceMount:s,children:n,container:r}=t,o=g(A,a);return e.jsx(Fe,{scope:a,forceMount:s,children:i.Children.map(n,d=>e.jsx(E,{present:s||o.open,children:e.jsx(ve,{asChild:!0,container:r,children:d})}))})};K.displayName=A;var N="DialogOverlay",V=i.forwardRef((t,a)=>{const s=B(N,t.__scopeDialog),{forceMount:n=s.forceMount,...r}=t,o=g(N,t.__scopeDialog);return o.modal?e.jsx(E,{present:n||o.open,children:e.jsx(ke,{...r,ref:a})}):null});V.displayName=N;var Se=je("DialogOverlay.RemoveScroll"),ke=i.forwardRef((t,a)=>{const{__scopeDialog:s,...n}=t,r=g(N,s);return e.jsx(Me,{as:Se,allowPinchZoom:!0,shards:[r.contentRef],children:e.jsx(y.div,{"data-state":O(r.open),...n,ref:a,style:{pointerEvents:"auto",...n.style}})})}),f="DialogContent",Q=i.forwardRef((t,a)=>{const s=B(f,t.__scopeDialog),{forceMount:n=s.forceMount,...r}=t,o=g(f,t.__scopeDialog);return e.jsx(E,{present:n||o.open,children:o.modal?e.jsx($e,{...r,ref:a}):e.jsx(qe,{...r,ref:a})})});Q.displayName=f;var $e=i.forwardRef((t,a)=>{const s=g(f,t.__scopeDialog),n=i.useRef(null),r=M(a,s.contentRef,n);return i.useEffect(()=>{const o=n.current;if(o)return we(o)},[]),e.jsx(X,{...t,ref:r,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:j(t.onCloseAutoFocus,o=>{var d;o.preventDefault(),(d=s.triggerRef.current)==null||d.focus()}),onPointerDownOutside:j(t.onPointerDownOutside,o=>{const d=o.detail.originalEvent,c=d.button===0&&d.ctrlKey===!0;(d.button===2||c)&&o.preventDefault()}),onFocusOutside:j(t.onFocusOutside,o=>o.preventDefault())})}),qe=i.forwardRef((t,a)=>{const s=g(f,t.__scopeDialog),n=i.useRef(!1),r=i.useRef(!1);return e.jsx(X,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var d,c;(d=t.onCloseAutoFocus)==null||d.call(t,o),o.defaultPrevented||(n.current||(c=s.triggerRef.current)==null||c.focus(),o.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:o=>{var u,p;(u=t.onInteractOutside)==null||u.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const d=o.target;((p=s.triggerRef.current)==null?void 0:p.contains(d))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&r.current&&o.preventDefault()}})}),X=i.forwardRef((t,a)=>{const{__scopeDialog:s,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:o,...d}=t,c=g(f,s),u=i.useRef(null),p=M(a,u);return Ee(),e.jsxs(e.Fragment,{children:[e.jsx(Ae,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:o,children:e.jsx(ye,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":O(c.open),...d,ref:p,onDismiss:()=>c.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(Le,{titleId:c.titleId}),e.jsx(Ge,{contentRef:u,descriptionId:c.descriptionId})]})]})}),I="DialogTitle",Y=i.forwardRef((t,a)=>{const{__scopeDialog:s,...n}=t,r=g(I,s);return e.jsx(y.h2,{id:r.titleId,...n,ref:a})});Y.displayName=I;var Z="DialogDescription",J=i.forwardRef((t,a)=>{const{__scopeDialog:s,...n}=t,r=g(Z,s);return e.jsx(y.p,{id:r.descriptionId,...n,ref:a})});J.displayName=Z;var ee="DialogClose",te=i.forwardRef((t,a)=>{const{__scopeDialog:s,...n}=t,r=g(ee,s);return e.jsx(y.button,{type:"button",...n,ref:a,onClick:j(t.onClick,()=>r.onOpenChange(!1))})});te.displayName=ee;function O(t){return t?"open":"closed"}var ae="DialogTitleWarning",[it,se]=De(ae,{contentName:f,titleName:I,docsSlug:"dialog"}),Le=({titleId:t})=>{const a=se(ae),s=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return i.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},We="DialogDescriptionWarning",Ge=({contentRef:t,descriptionId:a})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${se(We).contentName}}.`;return i.useEffect(()=>{var o;const r=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");a&&r&&(document.getElementById(a)||console.warn(n))},[n,t,a]),null},He=H,Ue=z,ze=K,oe=V,ne=Q,re=Y,ie=J,Be=te;const Ke=He,Ve=Ue,Qe=ze,le=i.forwardRef(({className:t,...a},s)=>e.jsx(oe,{ref:s,className:h("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));le.displayName=oe.displayName;const de=i.forwardRef(({className:t,children:a,...s},n)=>e.jsxs(Qe,{children:[e.jsx(le,{}),e.jsxs(ne,{ref:n,className:h("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[a,e.jsxs(Be,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));de.displayName=ne.displayName;const ce=({className:t,...a})=>e.jsx("div",{className:h("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});ce.displayName="DialogHeader";const ue=i.forwardRef(({className:t,...a},s)=>e.jsx(re,{ref:s,className:h("text-lg font-semibold leading-none tracking-tight",t),...a}));ue.displayName=re.displayName;const ge=i.forwardRef(({className:t,...a},s)=>e.jsx(ie,{ref:s,className:h("text-sm text-muted-foreground",t),...a}));ge.displayName=ie.displayName;function Xe(){const{toast:t}=be(),[a,s]=i.useState(!1),[n,r]=i.useState(""),[o,d]=i.useState(""),[c,u]=i.useState(""),[p,m]=i.useState(""),[D,T]=i.useState(""),[F,S]=i.useState(""),{data:C,isLoading:pe}=Ce({queryKey:["/api/movies"],queryFn:()=>P.getMovies()}),R=q({mutationFn:()=>P.addMovie({title:n,synopsis:o,posterUrl:c,duration:parseInt(p),genres:D.split(",").map(l=>l.trim()),rating:parseFloat(F)}),onSuccess:()=>{$.invalidateQueries({queryKey:["/api/movies"]}),t({title:"Movie added",description:"The movie has been added successfully"}),s(!1),r(""),d(""),u(""),m(""),T(""),S("")},onError:l=>{t({title:"Failed to add movie",description:l.message,variant:"destructive"})}}),k=q({mutationFn:l=>P.deleteMovie(l),onSuccess:()=>{$.invalidateQueries({queryKey:["/api/movies"]}),t({title:"Movie deleted",description:"The movie has been removed"})},onError:l=>{t({title:"Failed to delete movie",description:l.message,variant:"destructive"})}}),fe=l=>{l.preventDefault(),R.mutate()};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Re,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Panel"}),e.jsxs(Ke,{open:a,onOpenChange:s,children:[e.jsx(Ve,{asChild:!0,children:e.jsxs(_,{"data-testid":"button-add-movie",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Add Movie"]})}),e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ce,{children:[e.jsx(ue,{children:"Add New Movie"}),e.jsx(ge,{children:"Add a new movie to the catalog"})]}),e.jsxs("form",{onSubmit:fe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"title",children:"Title"}),e.jsx(v,{id:"title",value:n,onChange:l=>r(l.target.value),required:!0,"data-testid":"input-title"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"synopsis",children:"Synopsis"}),e.jsx(W,{id:"synopsis",value:o,onChange:l=>d(l.target.value),required:!0,"data-testid":"input-synopsis"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"posterUrl",children:"Poster URL"}),e.jsx(v,{id:"posterUrl",value:c,onChange:l=>u(l.target.value),required:!0,"data-testid":"input-poster-url"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"duration",children:"Duration (minutes)"}),e.jsx(v,{id:"duration",type:"number",value:p,onChange:l=>m(l.target.value),required:!0,"data-testid":"input-duration"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"rating",children:"Rating (0-10)"}),e.jsx(v,{id:"rating",type:"number",step:"0.1",min:"0",max:"10",value:F,onChange:l=>S(l.target.value),required:!0,"data-testid":"input-rating"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"genres",children:"Genres (comma-separated)"}),e.jsx(v,{id:"genres",value:D,onChange:l=>T(l.target.value),placeholder:"Action, Drama, Sci-Fi",required:!0,"data-testid":"input-genres"})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:R.isPending,"data-testid":"button-submit-movie",children:R.isPending?"Adding...":"Add Movie"})]})]})]})]}),pe?e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((l,me)=>e.jsx("div",{className:"h-24 bg-muted rounded-lg animate-pulse"},me))}):e.jsx("div",{className:"space-y-4",children:C==null?void 0:C.map(l=>e.jsx(_e,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2","data-testid":`text-movie-title-${l.id}`,children:l.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-2",children:l.synopsis}),e.jsxs("div",{className:"flex gap-2 text-sm",children:[e.jsxs("span",{children:[l.duration," min"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Rating: ",l.rating]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:l.genres.join(", ")})]})]}),e.jsx(_,{variant:"destructive",size:"icon",onClick:()=>k.mutate(l.id),disabled:k.isPending,"data-testid":`button-delete-${l.id}`,children:e.jsx(Oe,{className:"w-4 h-4"})})]})},l.id))})]})]})}function lt(){return e.jsx(Pe,{children:e.jsx(Xe,{})})}export{lt as default};
